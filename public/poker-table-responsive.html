<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>PokerGeek.ai - Responsive Table</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Responsive Styles -->
    <link rel="stylesheet" href="/css/poker-table-responsive.css">
</head>
<body>
    <!-- App Container - Flex Column -->
    <div class="app-container">
        <!-- Game Area - Flex Center -->
        <main class="game-area">
            <!-- Table Container with Aspect Ratio -->
            <div class="table-container">
                <!-- Table Surface -->
                <div class="table-surface">
                    <!-- Seats Grid -->
                    <div class="seats-grid" id="seatsGrid">
                        <!-- Seats will be generated by JavaScript -->
                    </div>
                    
                    <!-- Table Center Content -->
                    <div class="table-center">
                        <div class="community-cards" id="communityCards">
                            <!-- Community cards will be added here -->
                        </div>
                        <div class="pot-display">
                            <div class="pot-label">POT</div>
                            <div class="pot-amount" id="potAmount">$0</div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Floating HUD - Outside main flow -->
    <aside class="floating-hud" id="floatingHud">
        <div class="hud-header">
            <div class="hud-brand">PokerGeek<span class="ai">.ai</span></div>
            <button class="hud-toggle" id="hudToggle" aria-label="Toggle HUD">
                <span class="visually-hidden">Toggle menu</span>
                ‚ñº
            </button>
        </div>
        <div class="hud-content">
            <div class="hud-info">
                <div class="hud-info-row">
                    <span class="hud-label">Room</span>
                    <span class="hud-value" id="roomCode">DEMO</span>
                </div>
                <div class="hud-info-row">
                    <span class="hud-label">Blinds</span>
                    <span class="hud-value" id="blindsInfo">$25/$50</span>
                </div>
                <div class="hud-info-row">
                    <span class="hud-label">Hand</span>
                    <span class="hud-value" id="handNumber">#42</span>
                </div>
            </div>
            <nav class="hud-actions">
                <button class="hud-button primary" id="hostControlsBtn">
                    üéÆ Host Controls
                </button>
                <button class="hud-button" id="settingsBtn">
                    ‚öôÔ∏è Settings
                </button>
                <button class="hud-button" id="leaveTableBtn">
                    üö™ Leave Table
                </button>
            </nav>
        </div>
    </aside>
    
    <!-- Action Bar - Fixed Position -->
    <div class="action-bar" id="actionBar">
        <div class="action-container">
            <!-- Quick Bets -->
            <div class="quick-bets">
                <button class="quick-bet" data-amount="0.5">¬Ω POT</button>
                <button class="quick-bet" data-amount="0.75">¬æ POT</button>
                <button class="quick-bet" data-amount="1">POT</button>
                <button class="quick-bet" data-amount="2">2√ó POT</button>
            </div>
            
            <!-- Bet Controls -->
            <div class="bet-controls">
                <div class="bet-slider" id="betSlider" role="slider" 
                     aria-label="Bet amount" 
                     aria-valuemin="50" 
                     aria-valuemax="5000" 
                     aria-valuenow="150">
                    <div class="bet-slider-fill" id="betSliderFill"></div>
                    <div class="bet-slider-handle" id="betSliderHandle"></div>
                </div>
                <input type="text" 
                       class="bet-amount-input" 
                       id="betAmountInput" 
                       value="$0"
                       aria-label="Bet amount input">
            </div>
            
            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="action-btn btn-fold" id="foldBtn">
                    <span>FOLD</span>
                    <span class="btn-hotkey">F</span>
                </button>
                <button class="action-btn btn-call" id="callBtn">
                    <span>CALL</span>
                    <span class="btn-amount">$0</span>
                    <span class="btn-hotkey">C</span>
                </button>
                <button class="action-btn btn-raise" id="raiseBtn">
                    <span>RAISE</span>
                    <span class="btn-amount">$0</span>
                    <span class="btn-hotkey">R</span>
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // Responsive seat positioning system
        class ResponsivePokerTable {
            constructor() {
                this.seatsGrid = document.getElementById('seatsGrid');
                this.communityCards = document.getElementById('communityCards');
                this.potAmount = document.getElementById('potAmount');
                this.actionBar = document.getElementById('actionBar');
                this.init();
            }
            
            init() {
                this.createSeats();
                this.setupDemo();
                this.setupResponsiveHandlers();
                this.setupActionControls();
            }
            
            createSeats() {
                // Generate 10 seats
                for (let i = 0; i < 10; i++) {
                    const seat = document.createElement('article');
                    seat.className = 'seat empty';
                    seat.setAttribute('data-position', i);
                    seat.setAttribute('data-seat-index', i);
                    seat.setAttribute('role', 'region');
                    seat.setAttribute('aria-label', `Seat ${i + 1}`);
                    
                    seat.innerHTML = `
                        <div class="seat-tile">
                            <div class="player-info">
                                <div class="player-avatar" aria-hidden="true">‚ûï</div>
                                <div class="player-details">
                                    <div class="player-name">Empty</div>
                                    <div class="player-stack">Seat ${i + 1}</div>
                                </div>
                            </div>
                            <div class="player-cards" role="img" aria-label="Player cards">
                                <!-- Cards will be added when player sits -->
                            </div>
                        </div>
                    `;
                    
                    this.seatsGrid.appendChild(seat);
                }
            }
            
            setupDemo() {
                // Demo players
                const demoPlayers = [
                    { position: 0, name: 'WALEED', stack: '$5,280', avatar: 'ü¶à', isMe: true, cards: ['hearts_A', 'hearts_K'] },
                    { position: 2, name: 'ProPlayer', stack: '$3,750', avatar: 'üéØ', cards: ['back', 'back'] },
                    { position: 4, name: 'Rocket', stack: '$8,875', avatar: 'üöÄ', cards: ['back', 'back'] },
                    { position: 6, name: 'Diamond', stack: '$11,200', avatar: 'üíé', cards: ['back', 'back'] },
                    { position: 8, name: 'Lucky', stack: '$2,100', avatar: 'üé≤', cards: ['back', 'back'] }
                ];
                
                demoPlayers.forEach(player => {
                    const seat = this.seatsGrid.querySelector(`[data-position="${player.position}"]`);
                    if (seat) {
                        seat.classList.remove('empty');
                        if (player.isMe) seat.classList.add('my-seat');
                        
                        const tile = seat.querySelector('.seat-tile');
                        tile.querySelector('.player-avatar').textContent = player.avatar;
                        tile.querySelector('.player-name').textContent = player.name;
                        tile.querySelector('.player-stack').textContent = player.stack;
                        
                        // Add cards
                        const cardsDiv = tile.querySelector('.player-cards');
                        cardsDiv.innerHTML = player.cards.map(card => 
                            `<div class="player-card" 
                                  style="background-image: url('/cards/${card}.png');"
                                  role="img"
                                  aria-label="${card === 'back' ? 'Hidden card' : `Card ${card}`}">
                             </div>`
                        ).join('');
                    }
                });
                
                // Add dealer button to position 4
                const dealerSeat = this.seatsGrid.querySelector('[data-position="4"]');
                if (dealerSeat) {
                    const dealerBtn = document.createElement('div');
                    dealerBtn.className = 'dealer-button';
                    dealerBtn.textContent = 'D';
                    dealerBtn.setAttribute('aria-label', 'Dealer');
                    dealerSeat.appendChild(dealerBtn);
                }
                
                // Add blind buttons
                const sbSeat = this.seatsGrid.querySelector('[data-position="6"]');
                if (sbSeat) {
                    const sbBtn = document.createElement('div');
                    sbBtn.className = 'blind-button sb';
                    sbBtn.textContent = 'S';
                    sbBtn.setAttribute('aria-label', 'Small blind');
                    sbSeat.appendChild(sbBtn);
                }
                
                const bbSeat = this.seatsGrid.querySelector('[data-position="8"]');
                if (bbSeat) {
                    const bbBtn = document.createElement('div');
                    bbBtn.className = 'blind-button bb';
                    bbBtn.textContent = 'B';
                    bbBtn.setAttribute('aria-label', 'Big blind');
                    bbSeat.appendChild(bbBtn);
                }
                
                // Add community cards
                const cards = ['hearts_A', 'spades_K', 'hearts_Q', 'clubs_J', 'diamonds_10'];
                this.communityCards.innerHTML = cards.map(card => 
                    `<div class="community-card" 
                          style="background-image: url('/cards/${card}.png');"
                          role="img"
                          aria-label="Community card ${card}">
                     </div>`
                ).join('');
                
                // Set pot
                this.potAmount.textContent = '$3,450';
                
                // Show action bar for demo
                setTimeout(() => {
                    this.actionBar.classList.add('show');
                    document.getElementById('callBtn').querySelector('.btn-amount').textContent = '$50';
                    document.getElementById('raiseBtn').querySelector('.btn-amount').textContent = '$150';
                }, 1000);
            }
            
            setupResponsiveHandlers() {
                // Handle window resize
                let resizeTimeout;
                window.addEventListener('resize', () => {
                    clearTimeout(resizeTimeout);
                    resizeTimeout = setTimeout(() => {
                        this.handleResize();
                    }, 100);
                });
                
                // Handle orientation change
                window.addEventListener('orientationchange', () => {
                    setTimeout(() => {
                        this.handleResize();
                    }, 100);
                });
                
                // Initial sizing
                this.handleResize();
            }
            
            handleResize() {
                // Update CSS custom properties based on viewport
                const vw = window.innerWidth;
                const vh = window.innerHeight;
                
                // Adjust table container if needed
                const tableContainer = document.querySelector('.table-container');
                if (vw < vh * 1.5) {
                    // Portrait or square viewport
                    tableContainer.style.width = '95%';
                } else {
                    // Landscape viewport
                    tableContainer.style.width = '90%';
                }
                
                // Log for debugging
                console.log(`Viewport: ${vw}x${vh}, Aspect: ${(vw/vh).toFixed(2)}`);
            }
            
            setupActionControls() {
                // Bet slider
                const slider = document.getElementById('betSlider');
                const sliderFill = document.getElementById('betSliderFill');
                const sliderHandle = document.getElementById('betSliderHandle');
                const amountInput = document.getElementById('betAmountInput');
                
                let isDragging = false;
                
                const updateSlider = (percentage) => {
                    percentage = Math.max(0, Math.min(100, percentage));
                    sliderFill.style.width = percentage + '%';
                    sliderHandle.style.left = percentage + '%';
                    
                    // Calculate amount
                    const minBet = 50;
                    const maxBet = 5000;
                    const amount = Math.round(minBet + (maxBet - minBet) * (percentage / 100));
                    amountInput.value = '$' + amount;
                    document.getElementById('raiseBtn').querySelector('.btn-amount').textContent = '$' + amount;
                    
                    // Update ARIA
                    slider.setAttribute('aria-valuenow', amount);
                };
                
                // Mouse/touch events
                const handleStart = (e) => {
                    isDragging = true;
                    handleMove(e);
                };
                
                const handleMove = (e) => {
                    if (!isDragging) return;
                    
                    const rect = slider.getBoundingClientRect();
                    const x = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                    const percentage = ((x - rect.left) / rect.width) * 100;
                    updateSlider(percentage);
                };
                
                const handleEnd = () => {
                    isDragging = false;
                };
                
                // Event listeners
                slider.addEventListener('mousedown', handleStart);
                slider.addEventListener('touchstart', handleStart);
                document.addEventListener('mousemove', handleMove);
                document.addEventListener('touchmove', handleMove);
                document.addEventListener('mouseup', handleEnd);
                document.addEventListener('touchend', handleEnd);
                
                // Quick bet buttons
                document.querySelectorAll('.quick-bet').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const multiplier = parseFloat(btn.getAttribute('data-amount'));
                        const pot = 3450; // Demo pot
                        const amount = Math.round(pot * multiplier);
                        const percentage = ((amount - 50) / (5000 - 50)) * 100;
                        updateSlider(percentage);
                    });
                });
                
                // HUD toggle
                document.getElementById('hudToggle').addEventListener('click', () => {
                    const hud = document.getElementById('floatingHud');
                    hud.classList.toggle('collapsed');
                    document.getElementById('hudToggle').textContent = 
                        hud.classList.contains('collapsed') ? '‚ñ∂' : '‚ñº';
                });
                
                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => {
                    if (e.target.tagName === 'INPUT') return;
                    
                    switch(e.key.toLowerCase()) {
                        case 'f':
                            document.getElementById('foldBtn').click();
                            break;
                        case 'c':
                            document.getElementById('callBtn').click();
                            break;
                        case 'r':
                            document.getElementById('raiseBtn').click();
                            break;
                    }
                });
                
                // Initial slider position
                updateSlider(30);
            }
        }
        
        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            new ResponsivePokerTable();
        });
    </script>
</body>
</html>
